this is chapter3 of exp branch